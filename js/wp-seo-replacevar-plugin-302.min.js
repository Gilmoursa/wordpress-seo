!function(){"use strict";var a=function(){this.replaceVars=wpseoReplaceVarsL10n.replace_vars,this.taxonomyRepository={},this.currentTaxonomies={},YoastSEO.app.registerPlugin("replaceVariablePlugin",{status:"ready"}),this.registerModifications(),this.isPost()&&(jQuery(".categorydiv").each(this.bindTaxonomyEvents.bind(this)),this.addTagEvents())};a.prototype.isPost=function(){return 0!==jQuery("#post_ID").length},a.prototype.isTaxonomy=function(){return 0!==jQuery("input[name=tag_ID]").length},a.prototype.registerModifications=function(){var a=this.replaceVariablesPlugin.bind(this);YoastSEO.app.registerModification("content",a,"replaceVariablePlugin",10),YoastSEO.app.registerModification("title",a,"replaceVariablePlugin",10),YoastSEO.app.registerModification("snippet_title",a,"replaceVariablePlugin",10),YoastSEO.app.registerModification("snippet_meta",a,"replaceVariablePlugin",10),YoastSEO.app.registerModification("data_page_title",a,"replaceVariablePlugin",10),YoastSEO.app.registerModification("data_meta_desc",a,"replaceVariablePlugin",10)},a.prototype.replaceVariablesPlugin=function(a){return"undefined"!=typeof a&&(a=this.replaceTitle(a),a=this.replaceTermTitle(a),a=this.replaceDefault(a),a=this.replaceParent(a),a=this.replaceDoubleSeparators(a),a=this.replaceExcerpt(a),this.isPost()&&(a=this.replaceCategory(a),a=this.replaceTag(a),a=this.replaceCustomTaxonomy(a)),this.isTaxonomy()&&(a=this.replaceTaxonomyDescription(a))),a},a.prototype.bindTaxonomyEvents=function(a,b){b=jQuery(b),b.on("wpListAddEnd",".categorychecklist",this.fetchTaxonomies.bind(this,b)),b.on("change","input[type=checkbox]",this.fetchTaxonomies.bind(this,b)),this.fetchTaxonomies(b)},a.prototype.addTagEvents=function(){if("undefined"==typeof MutationObserver)jQuery(".tagsdiv").on("DOMSubtreeModified propertychange",".tagchecklist",this.declareReloaded.bind(this));else{var a=new MutationObserver(this.declareReloaded.bind(this));a.observe(document.querySelector(".tagchecklist"),{attributes:!1,childList:!0,characterData:!1})}},a.prototype.replaceTitle=function(a){var b=YoastSEO.app.rawData.title;return a=a.replace(/%%title%%/g,b)},a.prototype.replaceTermTitle=function(a){var b=YoastSEO.app.rawData.name;return a=a.replace(/%%term_title%%/g,b)},a.prototype.replaceParent=function(a){var b=document.getElementById("parent_id");return null!==b&&"undefined"!=typeof b.options&&b.options[b.selectedIndex].text!==wpseoReplaceVarsL10n.no_parent_text&&(a=a.replace(/%%parent_title%%/,b.options[b.selectedIndex].text)),a},a.prototype.replaceDoubleSeparators=function(a){var b=YoastSEO.app.stringHelper.addEscapeChars(this.replaceVars.sep),c=new RegExp(b+" "+b,"g");return a=a.replace(c,this.replaceVars.sep)},a.prototype.replaceExcerpt=function(a){return"undefined"!=typeof YoastSEO.app.rawData.excerpt&&(a=a.replace(/%%excerpt_only%%/g,YoastSEO.app.rawData.excerpt),a=a.replace(/%%excerpt%%/g,YoastSEO.app.rawData.excerpt)),a},a.prototype.replaceDefault=function(a){return a=a.replace(/%%focuskw%%/g,YoastSEO.app.stringHelper.stripAllTags(YoastSEO.app.rawData.keyword)),jQuery.each(this.replaceVars,function(b,c){a=a.replace("%%"+b+"%%",c)}),a},a.prototype.replaceCategory=function(a){return this.isPost()&&(a=a.replace(/%%category%%/g,this.getTaxonomyReplaceVar("category"))),a},a.prototype.replaceCustomTaxonomy=function(a){return jQuery.each(this.currentTaxonomies,function(b){"category"!==b&&(a=a.replace("%%ct_"+b+"%%",this.getTaxonomyReplaceVar(b)))}.bind(this)),a},a.prototype.getTaxonomyReplaceVar=function(a){return void 0!==this.currentTaxonomies[a]?jQuery.unique(this.currentTaxonomies[a]).join(", "):""},a.prototype.replaceTag=function(a){return this.isPost()&&(a=a.replace(/%%tag%%/g,jQuery(" #tax-input-post_tag").val())),a},a.prototype.replaceTaxonomyDescription=function(a){var b=YoastSEO.app.rawData.text;return a=a.replace(/%%category_description%%/g,b),a=a.replace(/%%tag_description%%/g,b),a=a.replace(/%%term_description%%/g,b),""!==wpseoReplaceVarsL10n.taxonomy_description&&(a=a.replace("%%"+wpseoReplaceVarsL10n.taxonomy_description+"%%",b)),a},a.prototype.fetchTaxonomies=function(a){var b=jQuery(a).find("input:checked"),c=jQuery(a).attr("id").replace("taxonomy-","");b.length>0&&this.setUnparsedTaxonomies(b,c),this.setCurrentTaxonomies(b,c),this.declareReloaded()},a.prototype.setUnparsedTaxonomies=function(a,b){void 0===this.taxonomyRepository[b]&&(this.taxonomyRepository[b]=[]),a.each(function(a,c){var d=jQuery(c).val();void 0===this.taxonomyRepository[b][d]&&(this.taxonomyRepository[b][d]=this.getTaxonomyName(c))}.bind(this))},a.prototype.getTaxonomyName=function(a){return jQuery(a).parent("label").clone().find("span").remove().end().text().trim()},a.prototype.setCurrentTaxonomies=function(a,b){this.currentTaxonomies[b]=[],a.length>0&&a.each(function(a,c){var d=this.taxonomyRepository[b][jQuery(c).val()];this.currentTaxonomies[b].push(d)}.bind(this))},a.prototype.declareReloaded=function(){YoastSEO.app.pluginReloaded("replaceVariablePlugin")},window.YoastReplaceVarPlugin=a}();